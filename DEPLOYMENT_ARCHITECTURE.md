# éƒ¨ç½²æ¶æ„è¯´æ˜

**æœ€åæ›´æ–°ï¼š2025-12-22**

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Vercel (å‰ç«¯)   â”‚  https://xxx.vercel.app
â”‚   Next.js 16     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ API è¯·æ±‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  VPS (åç«¯)      â”‚  93.127.133.204:54322
â”‚  Payload CMS     â”‚  https://api-nav.expertbeacon.com
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ ç›´æ¥è¿æ¥
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL 16   â”‚  93.127.133.204 (å®¹å™¨å†…)
â”‚  VPS Supabase    â”‚  1791+ APIs
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”§ éƒ¨ç½²é…ç½®

### åç«¯æœåŠ¡
- **ä½ç½®**: VPS (93.127.133.204)
- **å®¹å™¨**: `api-navigator-backend`
- **ç«¯å£**: 3001 (å†…éƒ¨) â†’ é€šè¿‡ Caddy åå‘ä»£ç†
- **åŸŸå**: https://api-nav.expertbeacon.com
- **æ•°æ®åº“è¿æ¥**: ç›´æ¥è¿æ¥æœ¬åœ° PostgreSQL å®¹å™¨

### å‰ç«¯æœåŠ¡
- **ä½ç½®**: Vercel
- **æ¡†æ¶**: Next.js 16.0.10
- **ç¯å¢ƒå˜é‡**: `NEXT_PUBLIC_API_URL=https://api-nav.expertbeacon.com`

### æ•°æ®åº“
- **ä½ç½®**: VPS (93.127.133.204)
- **å®¹å™¨**: `api-navigator-postgres`
- **ç«¯å£**: 54322 (å®¿ä¸»æœº) â†’ 5432 (å®¹å™¨å†…)
- **ç‰ˆæœ¬**: PostgreSQL 16-alpine
- **ç‰¹æ€§**: pg_trgm æ‰©å±•ï¼ˆæ¨¡ç³Šæœç´¢ï¼‰

## ğŸ”Œ æœ¬åœ°å¼€å‘è¿æ¥æ–¹å¼

### æ–¹å¼ 1: ç›´æ¥è¿æ¥ VPS PostgreSQLï¼ˆæ¨èï¼‰
```bash
# apps/backend/.env
DATABASE_URI=postgresql://payload:ApiNav_Secure_2025_PG@93.127.133.204:54322/api_navigator
```

**ä¼˜ç‚¹**:
- ä¸éœ€è¦ SSH éš§é“
- é…ç½®ç®€å•
- ä¸ç”Ÿäº§ç¯å¢ƒæ•°æ®ä¸€è‡´

**ç¼ºç‚¹**:
- éœ€è¦ VPS é˜²ç«å¢™å¼€æ”¾ 54322 ç«¯å£
- ç½‘ç»œå»¶è¿Ÿè¾ƒé«˜ï¼ˆ~30-50msï¼‰

### æ–¹å¼ 2: SSH éš§é“ï¼ˆå¤‡é€‰ï¼‰
```bash
# åˆ›å»ºéš§é“
ssh -f -N -L 54323:127.0.0.1:5432 vps-supabase

# apps/backend/.env
DATABASE_URI=postgres://payload:ApiNav_Secure_2025_PG@127.0.0.1:54323/api_navigator
```

**ä¼˜ç‚¹**:
- æ›´å®‰å…¨ï¼ˆä¸æš´éœ²æ•°æ®åº“ç«¯å£ï¼‰
- å»¶è¿Ÿæ›´ä½

**ç¼ºç‚¹**:
- éœ€è¦ä¿æŒ SSH è¿æ¥
- éœ€è¦ VPN (Tailscale)

### æ–¹å¼ 3: æœ¬åœ° PostgreSQLï¼ˆè°ƒè¯•ç”¨ï¼‰
```bash
# å¯åŠ¨æœ¬åœ°æ•°æ®åº“
docker compose up -d postgres

# apps/backend/.env
DATABASE_URI=postgres://payload:payload@127.0.0.1:54322/api_navigator
```

**é€‚ç”¨åœºæ™¯**: ä»…ç”¨äºæœ¬åœ°å¼€å‘/æµ‹è¯•ï¼Œæ•°æ®ä¸ä¸ç”Ÿäº§åŒæ­¥

## ğŸ“ é‡è¦æé†’

### âš ï¸ æ•°æ®åº“è¿æ¥é…ç½®
- **ç”Ÿäº§ç¯å¢ƒï¼ˆVPSï¼‰**: å®¹å™¨é—´é€šè¿‡ Docker network ç›´æ¥è¿æ¥ `postgres:5432`
- **æœ¬åœ°å¼€å‘**: ç›´æ¥è¿æ¥ VPS `93.127.133.204:54322`
- **å‰ç«¯ï¼ˆVercelï¼‰**: é€šè¿‡ HTTPS API `https://api-nav.expertbeacon.com`

### âš ï¸ ç¯å¢ƒå˜é‡
- åç«¯ `.env` ä¸æäº¤åˆ° Gitï¼ˆåŒ…å«æ•°æ®åº“å¯†ç ï¼‰
- å‰ç«¯ `.env.local` å¯ä»¥æäº¤ï¼ˆä»…å…¬å¼€ API URLï¼‰

### âš ï¸ éƒ¨ç½²æµç¨‹
1. **åç«¯æ›´æ–°**:
   - ä»£ç  push åˆ° VPS
   - é‡æ–°æ„å»º Docker é•œåƒ
   - é‡å¯å®¹å™¨

2. **å‰ç«¯æ›´æ–°**:
   - Push åˆ° GitHub
   - Vercel è‡ªåŠ¨éƒ¨ç½²

## ğŸ”— è®¿é—®åœ°å€

- **å‰ç«¯ï¼ˆVercelï¼‰**: https://xxx.vercel.app
- **åç«¯ API**: https://api-nav.expertbeacon.com
- **Admin é¢æ¿**: https://api-nav.expertbeacon.com/admin
- **å¥åº·æ£€æŸ¥**: https://api-nav.expertbeacon.com/api/health

## ğŸ“Š æ•°æ®ç»Ÿè®¡

- **API æ€»æ•°**: 1791+
- **åˆ†ç±»æ•°**: 1+
- **æ•°æ®åº“å¤§å°**: ~XXX MB
- **æ›´æ–°é¢‘ç‡**: æ¯æ—¥åŒæ­¥ 1 æ¬¡

---

**æœ€åéªŒè¯**: 2025-12-22 14:37 CST
